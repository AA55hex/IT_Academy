

name: Build-Test-Install


on:
  
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]


  workflow_dispatch:

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

          
      - name: Prelude
        run: |
          sudo apt-get install cmake gcc ninja-build
          sudo apt-get install libsdl2-dev
          mkdir build 

      - name: Task 1 - Build Test
        run: |
          cd Task_1/build
          cmake -G Ninja -DCMAKE_BUILD_TYPE=DEBUG .. -DCMAKE_INSTALL_PREFIX=/usr
          cmake --build .
      
      - name: Task 1 - CTest Test
        run: |
          cd Task_1/build
          cmake --ctest .
          
      - name: Task 1 - Installation Test
        run: |
          cd Task_1/build
          sudo cmake --install .
          Test hello world
          
      - name: Task 2 - Build Test
        run: |
          cd Task_2/build
          cmake -G Ninja -DCMAKE_BUILD_TYPE=DEBUG .. -DCMAKE_INSTALL_PREFIX=/usr
          cmake --build .
      
      - name: Task 2 - CTest Test
        run: |
          cd Task_2/build
          cmake --ctest .
          
      - name: Task 2 - Installation Test
        run: |
          cd Task_2/build
          sudo cmake --install .
          sdl2-version-test
